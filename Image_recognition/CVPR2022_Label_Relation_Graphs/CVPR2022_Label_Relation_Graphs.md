
# [CVPR2022] Label Relation Graphs Enhanced Hierarchical Residual Network for Hierarchical Multi-Granularity Classification

## 本文动机
基于有监督式深度学习的图像识别任务中一个方面要求是构建整理大规模、高质量的标注数据，这就对图像质量和标注人员的背景知识有比较高的要求。例如，在细粒度分类任务中，标注人员需要依赖大量的领域知识去区分各种种类的鸟以及不同型号的舰船，如图 1 所示。
![图1](图1.png)  

在图 1 中，标注人员需要借助鸟类专家的知识才能辨认黑脚信天翁与黑背信天翁，拥有一般鸟类知识的人员或许会将这两种鸟类归类为信天翁，而缺乏鸟类知识的人员可能只会将这两种鸟类归类为鸟。类似地，标注人员需要借助军事舰船专家的知识才能有效区分尼米兹级航母与企业级航母，而缺乏相关背景知识的人员可能会将这两类舰船归类为航母。也就是说，同一张图片会被拥有不同背景知识的标注人员标注到不同层级粒度的类别上。

除了背景知识对标注产生的影响，诸如鸟类辨别中的关键区域被遮挡、图像分辨率较低、或者图像比较模糊等图像质量因素也会干扰标注人员对于图像目标属于层级多粒度标签中的哪一类的判断，如图 2 所示。

![图2](图2.png)  
## 方法
网络总体结构与训练流程：  
![network](network.png)  
输入图像，然后经过AMG网络得到Attention map。然后把原图和Attention map进行逐元素相乘，得到的结果再输入DME网络得到最终的密度图。整体的训练流程是：先训练AMG，收敛后固定住AMG的参数，再训咯DME。  
这里面我不太理解的一点是Attention map的ground truth是如何生成的？作者文中并没有相关部分。  
然后AMG的具体架构：  
![AMG](AMG.png)  
里面也没有很多值得说的地方，AMG是一个二分类器，用[0,1]来表示该像素有人or not。  
![DME](DME.png)  
这个里面与之前工作不同的是引入了deformable卷积，能够更好的进行特征提取。  

## 实验结果
ShTechA MAE：63.2 效果OK。(但里面有将attention map做一些阈值处理来得到这个效果，因此在有监督方法里面再继续这个方向做下去的意义可能不大)。

## 其他
希望作者能给出Attention map的ground truth是如何生成的说明。或者我理解错了，AME根本不需要ground truth。
